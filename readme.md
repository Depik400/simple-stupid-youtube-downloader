–ë—Ä–∞—Ç, –±–µ–∑ –ø—Ä–æ–±–ª–µ–º, –≤–æ—Ç –≤–µ—Å—å `README.md` –≤ –∫–∞–≤—ã—á–∫–∞—Ö –∫–∞–∫ —Ç–µ–∫—Å—Ç! üòé –ü–æ–ø—Ä–æ–±—É–π —Ç–µ–ø–µ—Ä—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—Å—Ç–∞–≤–∏—Ç—å –≤ —Ñ–∞–π–ª.


# youtube_downloader

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

`youtube_downloader` ‚Äî —ç—Ç–æ HTTP-—Å–µ—Ä–≤–µ—Ä –Ω–∞ Go (Golang), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫–∞—á–∏–≤–∞—Ç—å –≤–∏–¥–µ–æ —Å YouTube –ø–æ —Å—Å—ã–ª–∫–µ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–∞—á–µ—Å—Ç–≤–∞. –°–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `yt-dlp` –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —á–µ—Ä–µ–∑ –≥–æ—Ä—É—Ç–∏–Ω—ã, —Ö—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –±–∞–∑–µ SQLite –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç–∏—Ç —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã –∏ –∑–∞–ø–∏—Å–∏ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –≤–µ–¥—ë—Ç—Å—è –≤ —Ñ–∞–π–ª `server.log`.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç GET-–∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `/download` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `url` (—Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ) –∏ `quality` (–∫–∞—á–µ—Å—Ç–≤–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `hd720`).
- –°–∫–∞—á–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ —Å –ø–æ–º–æ—â—å—é `yt-dlp`, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–ª–µ–∏–≤–∞—è –≤–∏–¥–µ–æ –∏ –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ `ffmpeg`.
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –µ—Å–ª–∏ –≤–∏–¥–µ–æ —Å —Ç–∞–∫–∏–º –∂–µ URL –∏ –∫–∞—á–µ—Å—Ç–≤–æ–º —É–∂–µ —Å–∫–∞—á–∞–Ω–æ –∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.
- –°—Ç–∞—Ç—É—Å—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤: `pending` (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è), `completed` (—É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ), `failed` (–æ—à–∏–±–∫–∞).
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞.
- –í–æ—Ä–∫–µ—Ä –ø—É–ª: –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5 –≤–æ—Ä–∫–µ—Ä–æ–≤).
- –û—á–∏—Å—Ç–∫–∞: —É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª—ã –∏ –∑–∞–ø–∏—Å–∏ –≤ –±–∞–∑–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤.
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –≤ —Ñ–∞–π–ª `server.log`.

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

1. **Go**: –í–µ—Ä—Å–∏—è 1.21 –∏–ª–∏ –≤—ã—à–µ (–¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–µ–∑ Docker).
2. **yt-dlp**: –î–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ —Å YouTube.
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: `pip install yt-dlp`
3. **ffmpeg**: –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ (—Å–∫–ª–µ–π–∫–∞ –≤–∏–¥–µ–æ –∏ –∞—É–¥–∏–æ).
   - –ù–∞ Ubuntu: `sudo apt-get install ffmpeg`
   - –ù–∞ Mac: `brew install ffmpeg`
   - –ù–∞ Windows: –°–∫–∞—á–∞—Ç—å —Å [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞](https://ffmpeg.org/download.html) –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ PATH.
4. **Docker**: –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –∑–∞–ø—É—Å–∫–∞—Ç—å —á–µ—Ä–µ–∑ Docker.

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–µ–∑ Docker
1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
   ```bash
   go get github.com/mattn/go-sqlite3
   pip install yt-dlp
   sudo apt-get install ffmpeg  # –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± –¥–ª—è –≤–∞—à–µ–π –û–°
   ```

2. **–°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç**:
   –ï—Å–ª–∏ –∫–æ–¥ –Ω–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `youtube_downloader.go` –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç—É–¥–∞ –∫–æ–¥ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞.

3. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `yt-dlp` –∏ `ffmpeg` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã**:
   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–º–∞–Ω–¥–∞–º–∏:
   ```bash
   yt-dlp --version
   ffmpeg -version
   ```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å Docker
1. **–°–æ–±–µ—Ä–∏—Ç–µ Docker-–æ–±—Ä–∞–∑**:
   ```bash
   docker build -t youtube_downloader .
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**:
   ```bash
   docker run -d -p 8080:8080 -v $(pwd)/data:/data youtube_downloader
   ```
   - `-p 8080:8080`: –ü—Ä–æ–∫–∏–¥—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç 8080 –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É.
   - `-v $(pwd)/data:/data`: –ú–æ–Ω—Ç–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `data` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤, –±–∞–∑—ã –∏ —Å–∫–∞—á–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã (–≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/data` –¥–ª—è Docker –∏–ª–∏ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –±–µ–∑ Docker):

- `youtube_downloader.go`: –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- `server.log`: –õ–æ–≥-—Ñ–∞–π–ª —Å –∑–∞–ø–∏—Å—è–º–∏ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å–µ—Ä–≤–µ—Ä–∞.
- `downloads.db`: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite —Å –∑–∞–ø–∏—Å—è–º–∏ –æ –∑–∞–ø—Ä–æ—Å–∞—Ö.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–¢–∞–±–ª–∏—Ü–∞ `downloads` –≤ `downloads.db` –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:
- `id` (INTEGER, PRIMARY KEY, AUTOINCREMENT): –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞.
- `url` (TEXT): –°—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ.
- `quality` (TEXT): –ö–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `hd1080`, `hd720`).
- `file_path` (TEXT): –ü—É—Ç—å –∫ —Å–∫–∞—á–∞–Ω–Ω–æ–º—É —Ñ–∞–π–ª—É (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏).
- `status` (TEXT): –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (`pending`, `completed`, `failed`).
- `created_at` (TIMESTAMP): –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏.

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –±–µ–∑ Docker
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø—Ä–æ–µ–∫—Ç–æ–º.
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
   ```bash
   go run youtube_downloader.go
   ```
   –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:8080`.

### –ó–∞–ø—É—Å–∫ —Å Docker
1. –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (—Å–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—ã—à–µ).
2. –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:8080`.

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
–°–¥–µ–ª–∞–π—Ç–µ GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ endpoint `/download` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `url` –∏ `quality`.

–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```
http://localhost:8080/download?url=https://www.youtube.com/watch?v=rFejpH_tAHM&quality=hd1080
```

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `url` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –°—Å—ã–ª–∫–∞ –Ω–∞ YouTube-–≤–∏–¥–µ–æ.
  - `quality` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π): –ö–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `hd1080`, `hd720`). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `hd720`.

–ü—Ä–∏–º–µ—Ä —Å `curl`:
```bash
curl -O "http://localhost:8080/download?url=https://www.youtube.com/watch?v=rFejpH_tAHM&quality=hd1080"
```

–ë—Ä–∞—É–∑–µ—Ä –∏–ª–∏ `curl` —Å–∫–∞—á–∞–µ—Ç —Ñ–∞–π–ª —Å –∏–º–µ–Ω–µ–º –≤–∏–¥–∞ `downloaded_123456.mp4`.

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∫–æ–¥—É

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
1. **HTTP-—Å–µ—Ä–≤–µ—Ä**:
   - –•–µ–Ω–¥–ª–µ—Ä `/download` (`downloadHandler`): –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç GET-–∑–∞–ø—Ä–æ—Å—ã, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–∑—É –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≥–æ—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É.
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–æ—Ä–∫–µ—Ä –ø—É–ª (`workerPool`) –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∏—Å–ª–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –∑–∞–¥–∞—á —Å–∫–∞—á–∏–≤–∞–Ω–∏—è.

2. **–í–æ—Ä–∫–µ—Ä –ø—É–ª**:
   - –ö–∞–Ω–∞–ª `workerPool` —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —á–∏—Å–ª–æ–º —Å–ª–æ—Ç–æ–≤ (`maxWorkers = 5`).
   - –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∑–∞–Ω–∏–º–∞–µ—Ç —Å–ª–æ—Ç –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –µ–≥–æ –ø–æ—Å–ª–µ.

3. **–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ**:
   - –§—É–Ω–∫—Ü–∏—è `downloadAndProcessVideo`: –í—ã–∑—ã–≤–∞–µ—Ç `yt-dlp` –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∫–∞—á–µ—Å—Ç–≤–æ–º. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–ª–µ–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ –∏ –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ `ffmpeg`.

4. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite**:
   - –¢–∞–±–ª–∏—Ü–∞ `downloads` —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–ø—Ä–æ—Å–∞—Ö.
   - –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞–ø–∏—Å—å —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending`.
   - –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ `completed` –∏–ª–∏ `failed`.

5. **–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –∑–∞–ø–∏—Å–µ–π**:
   - –ì–æ—Ä—É—Ç–∏–Ω–∞ `cleanupWorker` –∫–∞–∂–¥—ã–µ —á–∞—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–∞–π–ª—ã –∏ –∑–∞–ø–∏—Å–∏ –≤ –±–∞–∑–µ, —É–¥–∞–ª—è–µ—Ç —Ç–µ, —á—Ç–æ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤.
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `sync.Map` (`fileRecords`) –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–∞—Ö.

6. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á**:
   - –§—É–Ω–∫—Ü–∏—è `recoverPendingTasks`: –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–ø–∏—Å–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending` –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –∏—Ö.

7. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è (–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤, –æ—à–∏–±–∫–∏) –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–∞–π–ª `server.log` —Å –ø–æ–º–æ—â—å—é `log.Logger`.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `main()`: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –≤–æ—Ä–∫–µ—Ä –ø—É–ª–∞, –∑–∞–ø—É—Å–∫ –≥–æ—Ä—É—Ç–∏–Ω –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.
- `downloadHandler(w, r)`: –•–µ–Ω–¥–ª–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ GET-–∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ `/download`.
- `processTask(task)`: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (–≤–∫–ª—é—á–∞—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤ –±–∞–∑–µ).
- `downloadAndProcessVideo(url, quality, outputFile)`: –õ–æ–≥–∏–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ `yt-dlp`.
- `cleanupWorker()`: –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –∑–∞–ø–∏—Å–µ–π –≤ –±–∞–∑–µ.
- `recoverPendingTasks()`: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.

---

## –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤
–ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏ –≤ `server.log`:
```
INFO: 2023/10/01 12:00:00 youtube_downloader.go:123: –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:8080
INFO: 2023/10/01 12:00:05 youtube_downloader.go:234: –ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É: url=https://www.youtube.com/watch?v=rFejpH_tAHM, quality=hd1080, output=downloaded_123456
INFO: 2023/10/01 12:00:15 youtube_downloader.go:456: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: downloaded_123456.mp4
```

---

## –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
1. **–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è**: –î–æ–±–∞–≤–∏—Ç—å WebSocket –∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Transfer-Encoding: chunked` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–ª–∏–µ–Ω—Ç—É.
2. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å API-–∫–ª—é—á–∏ –∏–ª–∏ HTTP-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞.
3. **–•—Ä–∞–Ω–∏–ª–∏—â–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤–º–µ—Å—Ç–æ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.
4. **–û—á–µ—Ä–µ–¥–∏ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –¥–ª—è –∑–∞–¥–∞—á —Å–∫–∞—á–∏–≤–∞–Ω–∏—è.
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –î–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/status?id=123`).

---

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- **–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è —Å—Ç–æ—Ä–æ–Ω–∞**: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ —Å YouTube –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∞—Ç—å –∏—Ö —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–∏—á–Ω—ã—Ö –Ω—É–∂–¥ –∏ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–∞–≤–æ–æ–±–ª–∞–¥–∞—Ç–µ–ª–µ–π.
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è YouTube**: –í–∏–¥–µ–æ —Å –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –∏–ª–∏ DRM-–∑–∞—â–∏—Ç–æ–π –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è.
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç `yt-dlp` –∏ `ffmpeg`**: –ï—Å–ª–∏ –æ–Ω–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

---

## –õ–∏—Ü–µ–Ω–∑–∏—è
–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è "–∫–∞–∫ –µ—Å—Ç—å". –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–π —Å—Ç—Ä–∞—Ö –∏ —Ä–∏—Å–∫. üòé
``